# ram_network.py

8章で紹介しているRAMのソースコードです。

* ram_network.py: 書籍内で示しているソースコードです。RAMの学習を行います。
* visualize.py: 直接書籍内で紹介していませんが、実験結果の項で示した画像を作成するスクリプトです。

データセットとしてMNISTを使用しています。MNISTには70000枚の画像が含まれていますが、そのうち60000枚を学習に使用し、残りの10000枚をテストセットとして使用します。`visualize.py`はテストセットにたいする識別結果の画像を作成します。

## 必要なパッケージ

* Chainer
* scikit-learn: データセットMNISTをダウンロードするために使用します
* numpy
* PIL (Pillow)

## 実行方法

### 学習

    python ram_netwok.py

実行するとMNISTデータセットをダウンロードし、RAMの学習を行います。学習途中でロスの値と精度を標準出力に出力します。ソースコード内で指定された10エポックを終了すると、学習済みのモデルを`saved_model`というファイル名で保存します。なおscikit-learnのデフォルトではダウンロードしたデータセットは`~/scikit_learn_data/`以下の保存されます。

### 画像の作成

    python visualize.py

実行するとカレントディレクトリにある`saved_model`を読みこみます。その学習済みモデルを使用し識別した結果を`out/`ディレクトリ以下に書きこみます。テストセットの1番目の画像にたいする正解ラベルと識別したラベルを1.txtというファイルに書きこみます。また1.jpgという注視位置を示した画像を作成します。これをテストセットのすべての画像にたいして実行します。

